{% load static %}
<!DOCTYPE>
<html>

<head>
  <title>INVOICE</title>
  <link rel="stylesheet" href="{% static 'assets/billcss/bootstrap.min.css' %}" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
  <style>
    * {
      border: none;
      box-sizing: content-box;
      color: inherit;
      font-family: Arial;
      font-size: inherit;
      font-style: inherit;
      font-weight: inherit;
      line-height: inherit;
      list-style: none;
      margin: 0;
      padding: 0;
      text-decoration: none;
      vertical-align: top;
    }

    html {
      overflow: auto;
      padding: 0.3in;
    }

    html {
      background: #999;
      cursor: default;
    }

    body {
      box-sizing: border-box;
      height: 11in;
      margin: 0 auto;
      padding: 0.1in;
      width: 8.5in;
    }

    body {
      background: #fff;
      border-radius: 1px;
      box-shadow: 0 0 1in -0.25in rgba(0, 0, 0, 0.5);
    }

    .hideextra {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* header */

    header {
      margin: 0 0 3em;
    }

    header:after {
      clear: both;
      content: "";
      display: table;
    }

    @page {
      size: A4;
    }

    @media print {
      #printPageButton, #addItem, #download {
        display: none;
      }
    }
  </style>
</head>

<body>
  <main style="padding: 10px">
    <div style="margin: 16px;" id='invoice'>
      {% comment %}
      <p><a href="{% url 'sale' %}" id="printPageButton">Home</a></p>
      {% endcomment %}
      <h1>&nbsp;</h1>
      <h3 class="text-center" style="width: 280px; position: relative; top: -66px; left: 250px">
        HEMKUNT TRANSPORT
      </h3>
  <span class='hide' id='pdf-title'>{{ consignment.id }}</span>


      <h6 class="text-center" style="transform: translateY(-65px); font-size: 14px">
        FLEET OWNER AND TRANSPORT CONTRACTOR & COMMISSION AGENTS<br />H.O :
        Brahmani Tarang, Vedvyas, Near Gurudawara , Rourkela - 769004<br /><b
          style="letter-spacing: 0.8px; text-decoration: underline">GSTIN: 21ANLPS9749N2Z1</b>
        <!-- <p style="display: inline" contenteditable><b>XXXXXXXXXXX</b></p> -->
      </h6>

      <section style="transform: translateY(-70px)">
        <table class="table table-condensed table-bordered table-responsive" style="width: 730px">
          <tr>
            <td colspan="3">No. NHRT/RKL : <b>{{consignment.nhrt_no}}</b></td>
            <td colspan="3" style="text-align: right">
              DATE : <b>{{ consignment.date | date:"d/m/Y" }}</b>
            </td>
          </tr>
        </table>

        <aside style="transform: translateY(-20px)">
          <table class="table table-bordered table-condensed" style="width: 730px">
            <tr>
              <td colspan="3">Details of Consignor</td>

              <td colspan="3">Details of Consignee</td>
            </tr>

            <tr>
              <td colspan="3">
                <h6 style="letter-spacing: 0.8px">
                  Name:{{consignment.consignor.name}}<br />
                  Address: {{consignment.consignor.address}}<br />
                  GSTIN: {{consignment.consignor.gstin}}<br />
                </h6>
              </td>

              <td colspan="3">
                <h6 style="letter-spacing: 0.8px">
                  Party : <b>{{consignment.consignee.name}}</b><br />
                  Address: <b>{{consignment.consignee.address}}</b><br />
                  GSTIN :<b>{{consignment.consignee.gstin}}</b><br />
                </h6>
              </td>
            </tr>
          </table>

          <table id="items" class="table table-condensed table-bordered table-responsive" style="
              transform: translateY(-20px);
              color: black;
              border: 1px solid black;
              width: 730px;
            ">
            <tr class="text-center">
              <th style="text-align: left">From : {{consignment.source}}</th>
              <th style="text-align: left">To : {{consignment.destination}}</th>
              <th style="text-align: left">Truck No : {{consignment.truck.truck_number}}</th>
            </tr>
          </table>

          <table id="items" class="table table-condensed table-bordered table-responsive" style="
              transform: translateY(-20px);
              color: black;
              border: 1px solid black;
              width: 730px;
            ">
            <tr style="text-align: left; font-size: 13px">
              <td colspan="6">
                Description : <b>{{consignment.goods}}</b>
              </td>
            </tr>
            {% comment %} <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">Discount (₹)</b>
              </td>

              <td colspan="2">
                <b>{{consignment.discount}}</b>
              </td>
            </tr> {% endcomment %}
            <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">Weight</b>
              </td>

              <td colspan="2">
                <b>{{consignment.weight}}</b>
              </td>
            </tr>
            <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">Rate (₹)</b>
              </td>

              <td colspan="2">
                <b>{{consignment.rate}}</b>
              </td>
            </tr>
            <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">Freight (₹)</b>
              </td>

              <td colspan="2">
                <b>{{consignment.freight}}</b>
              </td>
            </tr>
            <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">Less Advance (₹)</b>
              </td>

              <td colspan="2">
                <b>{{consignment.advance}}</b>
              </td>
            </tr>
            <tr class="hideextra" style="text-align: right">
              <td colspan="4">
                <b style="font-size: 14px">To Be Billed (₹)</b>
              </td>

              <td colspan="2">
                <b>{{consignment.remaining_payment}}</b>
              </td>
            </tr>

            <tr class="hideextra" style:"font-size:13px; font-weight:900; text-align:left;">
              <td colspan="6">

                <h5>E Way Bill No. <b
                    style="text-decoration: underline dotted;; letter-spacing: 0.5px">{{consignment.e_way_bill}}</b>
                </h5>
                <h5>Invoice No. <b
                    style="text-decoration: underline dotted; letter-spacing: 0.5px">{{consignment.id}}</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  Value : <b style="text-decoration: underline dotted;">{{consignment.goods_value}}</b>
                  <h5>
                    <h5>&nbsp;</h5>
                    <p>
                      Our Bank: AXIS BANK LTD.<br />

                      Account Number : 918020015662314
                      <br />IFSC Code: UTIB0001067
                    </p>
              </td>
            </tr>

            <tr class="hideextra" style:"font-size:13px; font-weight:900;">
              <td colspan="5" style="text-align:right">
                <h5>Signature of Booking Clerk</h5>

              </td>
            </tr>
          </table>


        </aside>

      </section>
    </div>

    <button type="button" class="btn btn-default" id="printPageButton" onclick="window.print()">
      Print
    </button>


    <div id='addItem' class="d-flex align-items-center flex-wrap text-nowrap">
      <br>
      <a style="text-decoration: none;" href="{% url 'trip' consignment.id %}">
        <button type="button" class="btn btn-outline-primary btn-icon-text mr-2 mb-2 mb-md-0">
          <i class="btn-icon-prepend" data-feather="plus"></i>

          Add Trip
        </button>
      </a>
    </div>


    <div class="d-flex align-items-center flex-wrap text-nowrap">
      <br>

      <button id="download" type="button" class="btn btn-outline-primary btn-icon-text mr-2 mb-2 mb-md-0">
        <i class="btn-icon-prepend" data-feather="plus"></i>

        Download
      </button>
    </div>
  </main>

  <script src="{% static 'assets/jss/jquery-1.3.2.min.js' %} "></script>

</body>

</html>
<script>
  
  document.getElementById("download")
    .addEventListener("click", () => {
      const invoice = this.document.getElementById("invoice");
      var opt = {
        // margin: 1,
        filename: `consignment_id_${document.getElementById('pdf-title').innerText}.pdf`,
        image: { type: 'jpeg', quality: 1 },
        html2canvas: { scale: 3 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };
      html2pdf().from(invoice).set(opt).save();
    })
</script>